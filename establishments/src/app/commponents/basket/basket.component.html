<app-custom-res style="display: none" [model]="{
  url:'basket_from_est',
  select: '-__v',
  security: true
}" (onRes)="result($event)" (onErr)="$event"></app-custom-res>
<div class="cont" *ngIf="basket">
  <div class="cont_h1">
    <div class="h-btn-cont">
      <button class="h_t-btn h_t btn-trans active">Замовлення</button>
      <button class="h_t-btn h_t btn-trans">Історія замовлень</button>
    </div>
  </div>
  <div class="ord_i active">
    <div class="collapsible-header ord_ct" tabindex="0">
      <div class="ord_ct_link">
      <span class="ord_ct_img pre-bg">
        <app-img [img]="{url:'est', name:'av'}" ></app-img>
      </span>
        <strong class="ord_ct_t">{{basket.name}}</strong>
      </div>

      <div class="ord_ct_in">
        <span class="ord_ct_time">{{ basket.data | date: "dd.MM.yy" }}</span>
        <span class="ord_ct_val">{{totalPrice}} грн</span>
        <span class="arrow">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 129 129" enable-background="new 0 0 30 30"> <g> <path d="m121.3,34.6c-1.6-1.6-4.2-1.6-5.8,0l-51,51.1-51.1-51.1c-1.6-1.6-4.2-1.6-5.8,0-1.6,1.6-1.6,4.2 0,5.8l53.9,53.9c0.8,0.8 1.8,1.2 2.9,1.2 1,0 2.1-0.4 2.9-1.2l53.9-53.9c1.7-1.6 1.7-4.2 0.1-5.8z"></path> </g></svg>
      </span>
      </div>
    </div>

    <div class="collapsible-body ord_pr-cont" style="display: block;">
      <form action="#" class="ord_form" *ngIf="basket.products">
        <ng-container *ngFor="let product of basket.products">
          <section class="ord_pr" >
            <label class="ord_pr_check">
              <input type="checkbox" checked="">
              <span></span>
            </label>

            <div class="ord_pr_img pre-bg">
              <div class="pr_ev">
                <span class="pr_ev-s ev-s_new"></span>
                <span class="pr_ev-s ev-s_xit"></span>
                <span class="pr_ev-s ev-s_int"></span>
              </div>
              <app-img [img]="{id: product.dishId.pic}"></app-img>
            </div>

            <div class="ord_pr_in">
              <div class="ord_pr_in_h">
                <h1 class="ord_pr_t">{{product.dishId.name}}</h1>
                <button type="button" class="ord_pr_btn-ed btn-trans">
                  <app-pop-prod-add></app-pop-prod-add>
                  <span class="ord_pr_btn-ed_svg">
                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 469.331 469.331" style="enable-background:new 0 0 15 15;"><g><path d="M438.931,30.403c-40.4-40.5-106.1-40.5-146.5,0l-268.6,268.5c-2.1,2.1-3.4,4.8-3.8,7.7l-19.9,147.4c-0.6,4.2,0.9,8.4,3.8,11.3c2.5,2.5,6,4,9.5,4c0.6,0,1.2,0,1.8-0.1l88.8-12c7.4-1,12.6-7.8,11.6-15.2c-1-7.4-7.8-12.6-15.2-11.6l-71.2,9.6l13.9-102.8l108.2,108.2c2.5,2.5,6,4,9.5,4s7-1.4,9.5-4l268.6-268.5c19.6-19.6,30.4-45.6,30.4-73.3S458.531,49.903,438.931,30.403z M297.631,63.403l45.1,45.1l-245.1,245.1l-45.1-45.1L297.631,63.403z M160.931,416.803l-44.1-44.1l245.1-245.1l44.1,44.1L160.931,416.803z M424.831,152.403l-107.9-107.9c13.7-11.3,30.8-17.5,48.8-17.5c20.5,0,39.7,8,54.2,22.4s22.4,33.7,22.4,54.2C442.331,121.703,436.131,138.703,424.831,152.403z"></path></g></svg>
              </span>
                </button>
              </div>
              <p class="ord_pr_in_d">{{product.dishId.about}}</p>
              <div class="ord_pr_in_add">
                <p class="ord_pr_in_d">Додатково:</p>
                <ul class="ord_pr_in_add_list">
                  <li class="ord_pr_in_add_i" *ngFor="let compl of product.dishId.dishcategory.complementbox">
                    <!--product.dishId.dishcategory.complementbox-->
                    <!--<span class="ord-check"></span>-->
                    <label class="ord_check">
                      <input type="checkbox" [checked]="compl.check == true"
                             (change)="checkPrice(compl, product)">
                      <span></span>
                    </label>
                    {{compl.name}}  ({{compl.massa}} - {{compl.price}} грн)
                  </li>
                </ul>
                <p class="ord_pr_in_add_com">{{product.comment}}</p>
              </div>
              <div class="pr_num">
                <span class="pr_num_t">Кількість:</span>
                <div class="pr_num_c">
                  <button type="button" class="btn-trans btn-pr_num" (click)="decPP(product)">
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 52 52" style="enable-background:new 0 0 25 25;"><g><path d="M26,0C11.664,0,0,11.663,0,26s11.664,26,26,26s26-11.663,26-26S40.336,0,26,0z M26,50C12.767,50,2,39.233,2,26S12.767,2,26,2s24,10.767,24,24S39.233,50,26,50z"></path><path d="M39,25H13c-0.552,0-1,0.447-1,1s0.448,1,1,1h26c0.552,0,1-0.447,1-1S39.552,25,39,25z"></path></g></svg>
                  </button>
                  <input class="pr_num_inp" type="number" name="number"
                         [(ngModel)]="product.count"
                         (blur)="totalPrice=totalPrice - product.totalPrice; checkPP(product)">
                  <button type="button" class="btn-trans btn-pr_num" (click)="addPP(product)">
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 52 52" style="enable-background:new 0 0 10 10;"><g><path d="M26,0C11.664,0,0,11.663,0,26s11.664,26,26,26s26-11.663,26-26S40.336,0,26,0z M26,50C12.767,50,2,39.233,2,26S12.767,2,26,2s24,10.767,24,24S39.233,50,26,50z"></path><path d="M38.5,25H27V14c0-0.553-0.448-1-1-1s-1,0.447-1,1v11H13.5c-0.552,0-1,0.447-1,1s0.448,1,1,1H25v12c0,0.553,0.448,1,1,1s1-0.447,1-1V27h11.5c0.552,0,1-0.447,1-1S39.052,25,38.5,25z"></path></g></svg>
                  </button>
                </div>
              </div>
              <div class="ord_pr_in_offer" *ngIf="product.portionCheck">
                <div>{{product.portionCheck.massa || product.portionCheck.name || ''}}</div>

                <div class="ord_pr_offer_prices">
                  <span class="c_t14">{{product.portionCheck.price}} грн</span>
                </div>
              </div>
              <div class="ord_pr_in_offer">
                <div>Ціна з додатками</div>
                <div class="ord_pr_offer_prices">
                  <span class="c_t14">{{product.totalPrice}} грн</span>
                </div>
              </div>
            </div>
          </section>
        </ng-container>

        <div class="ord_in">
          <p class="ord_in_i">
            <span class="ord_in_i-t">Статус замовленя:</span>
            <span class="ord_in_i-val ev">нове</span>
          </p>
          <p class="ord_in_i">
            <span class="ord_in_i-t">Загальна вартість:</span>
            <span class="ord_in_i-val">{{totalPrice}} грн.</span>
          </p>
        </div>

        <div class="ord_cm">
          <textarea class="ord_cm_t" placeholder="Коментар до страви"></textarea>
          <div  class="ord_cm_t-f"></div>
        </div>

        <ul class="collapsible collapsible-ord dt">
          <li class="dt_I active">
            <div class="collapsible-header dt_h" tabindex="0">
              <span class="dt_h_t">Деталі замовленя</span>
              <span class="dt_h_svg">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 129 129" enable-background="new 0 0 30 30"> <g> <path d="m121.3,34.6c-1.6-1.6-4.2-1.6-5.8,0l-51,51.1-51.1-51.1c-1.6-1.6-4.2-1.6-5.8,0-1.6,1.6-1.6,4.2 0,5.8l53.9,53.9c0.8,0.8 1.8,1.2 2.9,1.2 1,0 2.1-0.4 2.9-1.2l53.9-53.9c1.7-1.6 1.7-4.2 0.1-5.8z"></path> </g></svg>
              </span>
            </div>
            <div class="collapsible-body dt_c" style="display: block;">
              <div class="dt_i">
                <span class="dt_t">Коментар:</span>
                <span class="dt_t">«Бла бла бла бла...»</span>
              </div>
              <div class="dt_i">
                <span class="dt_t">Тип замовлення:</span>
                <span class="dt_t">замовлення столика</span>
              </div>
              <div class="dt_i">
                <span class="dt_t">Адреса закладу:</span>
                <span class="dt_t">Луцк, пр.Воли 21</span>
              </div>
              <div class="dt_i">
                <span class="dt_t">Телефон:</span>
                <span class="dt_t">380995812374</span>
              </div>
              <div class="dt_i">
                <span class="dt_t">Час і дата:</span>
                <span class="dt_t">31-05-18 о 20:00</span>
              </div>
              <div class="dt_i">
                <span class="dt_t">Вид оплати:</span>
                <span class="dt_t">розрахуюсь на місці</span>
              </div>
              <div class="dt_i">
                <span class="dt_t">Вартість замовлення:</span>
                <span class="dt_t">{{totalPrice}} грн</span>
              </div>
            </div>
          </li>
        </ul>
        <div class="ord_btn-cont">
          <app-to-order></app-to-order>
          <button class="btn-red ord_btn">скасувати</button>
        </div>

      </form>
    </div>
  </div>
</div>
