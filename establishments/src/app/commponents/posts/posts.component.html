<ng-container *ngIf="!posts">
  <div class="cont pst">
    <div class="pst_in">
      <span class="img40 pre-bg"></span>
      <span class="pre-in_us pre-bg"></span>
      <div class="pre-in_dt pre-bg"></div>
      <div class="in_us-drop pre-drop pre-bg"></div>
    </div>
    <div class="pst_cnt">
      <p class="pst_d pre-pst_d pre-bg"></p>
      <div class="pst_img">
        <div class="pre-img">
          <div class="pre-pst_img_i pre-bg"></div>
        </div>
      </div>
    </div>
    <div class="pst_btn pre-bg"></div>
  </div>
  <div class="cont pst">
    <div class="pst_in">
      <span class="img40 pre-bg"></span>
      <span class="pre-in_us pre-bg"></span>
      <div class="pre-in_dt pre-bg"></div>
      <div class="in_us-drop pre-drop pre-bg"></div>
    </div>
    <div class="pst_cnt">
      <p class="pst_d pre-pst_d pre-bg"></p>
      <div class="pst_img ">
        <div class="pre-img array">
          <div class="pre-pst_img_i pre-bg"></div>
          <div class="pre-pst_img_i pre-bg"></div>
        </div>
      </div>
    </div>
    <div class="pst_btn pre-bg"></div>
  </div>
</ng-container>

<ng-container *ngIf="posts">
  <ng-container *ngFor="let post of posts">
    <ng-container *ngIf="post.isActia">
      <ng-container *ngIf="!post.share.userIdShare">
        <article class="cont pst">
          <div class="pst_in">
            <span>
              <img class="img img40"
              [srcset]="'/-px100-'+post.inPlace.id.av.picCrop.slice(1)+' 100w, /-px60-'+post.inPlace.id.av.picCrop.slice(1)+' 60w'"
              [src]="'/-px60-'+post.inPlace.id.av.picCrop.slice(1)">
              <!--<app-img size="60" class="img40 pre-bg" [img]="{id:post.inPlace.id.av}"></app-img>-->
            </span>
            <span class="in_us">
              <span class="us_zv">{{post.des}}
              </span>
            </span>

            <p class="in_dt">
              <time>{{post.data | date:"dd.MM.yyy HH:mm"}}</time>
            </p>
          </div>

          <div class="pst_cnt">
            <div class="pst_img">
              <div class="cont-img" [class.array]="post.img.length >= 2">
                <ng-container *ngFor="let img of post.img">
                  <img class="img"
                  [srcset]="'/-px768-'+img.picCrop.slice(1)+' 768w, /-px400-'+img.picCrop.slice(1)+' 400w'"
                  [src]="'/-px768-'+img.picCrop.slice(1)"> 
                </ng-container> 
                <!--<app-img class="img_i" *ngFor="let img of post.img" [img]="{id:img}"></app-img>-->
              </div>
            </div>
          </div>
        </article>
      </ng-container>
    </ng-container>
    <ng-container *ngIf="!post.isActia">
      <ng-container *ngIf="!post.share.userIdShare">
        <article class="cont pst">
          <div class="pst_in">
            <a href="{{host}}/user/{{post.userId._id}}">
              <img class="img img40"
              [srcset]="'/-px100-'+post.userId.photo.picCrop.slice(1)+' 100w, /-px60-'+post.userId.photo.picCrop.slice(1)+' 60w'"
              [src]="post.userId.photo.picCrop">
              <!--<app-img size="60" class="img40 pre-bg" [img]="{id:post.userId.photo}"></app-img>-->
            </a>
            <span class="in_us">
            <a class="name"  href="{{host}}/user/{{post.userId._id}}">{{post.userId.firstName}} {{post.userId.lastName}}</a>
            <span *ngIf="post.img.length > 0"> додав(ла) фото</span>
            <span *ngIf="post.img.length == 0"> додав(ла) допис</span>
            <ng-container *ngIf="post.withFriend.length > 0"> разом з
              <a href="{{host}}/user/{{friend._id}}" class="us_fr-name" *ngFor="let friend of post.withFriend">
                {{friend.firstName}}
              </a>
            </ng-container>
            <span class="us_zv"> у
              <span class="us_zv_link">
                <img class="img us_zv_img"
                [srcset]="'/-px100-'+post.inPlace.id.av.picCrop.slice(1)+' 100w, /-px60-'+post.inPlace.id.av.picCrop.slice(1)+' 60w'"
                [src]="'/-px60-'+post.inPlace.id.av.picCrop.slice(1)">
                <!--<app-img size="20" class="us_zv_img" [img]="{id:post.inPlace.id.av}"></app-img>-->
                <strong class="name">{{post.inPlace.id.name}}</strong>
              </span>
            </span>
          </span>

            <p class="in_dt">
              <time>{{post.data | date:"dd.MM.yyy HH:mm"}}</time>
            </p>

            <div class="in_us-drop" *ngIf="post.id == cookie.get('userid')">
            <span class="in_us_btn-ul" (click)="inSelect.classList.toggle('active')">
              <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" x="0px" y="0px" viewBox="0 0 490 490"><g><g><path d="M304.5,245c0-32.8-26.7-59.5-59.5-59.5s-59.5,26.7-59.5,59.5s26.7,59.5,59.5,59.5S304.5,277.8,304.5,245z M245,280c-19.3,0-35-15.7-35-35s15.7-35,35-35s35,15.7,35,35S264.3,280,245,280z"/><path d="M59.5,185.5C26.7,185.5,0,212.2,0,245s26.7,59.5,59.5,59.5S119,277.8,119,245S92.3,185.5,59.5,185.5z M59.5,280c-19.3,0-35-15.7-35-35s15.7-35,35-35s35,15.7,35,35S78.8,280,59.5,280z"/><path d="M430.5,185.5c-32.8,0-59.5,26.7-59.5,59.5s26.7,59.5,59.5,59.5S490,277.8,490,245S463.3,185.5,430.5,185.5z M430.5,280c-19.3,0-35-15.7-35-35s15.7-35,35-35s35,15.7,35,35S449.8,280,430.5,280z"/></g></g></svg>
            </span>
              <ul #inSelect class="in_us_ul" tabindex="0"
                  (click)="inSelect.classList.remove('active')">
                <!--<li class="in_us_l">-->
                <!--<span>Відкрити у новій вкладці</span>-->
                <!--</li>-->
                <li class="in_us_l" *ngIf="post.id == cookie.get('userid')"
                    (click)="deletePost(post)">
                  <span>Видалити</span>
                </li>
              </ul>
            </div>
          </div>

          <div class="pst_cnt">
            <p class="pst_d">{{post.des}}</p>
            <div class="pst_img">
              <div class="cont-img" [class.array]="post.img.length >= 2">
                <ng-container *ngFor="let img of post.img">
                  <img class="img"
                  [srcset]="'/-px768-'+img.picCrop.slice(1)+' 768w, /-px400-'+img.picCrop.slice(1)+' 400w'"
                  [src]="'/-px768-'+img.picCrop.slice(1)"> 
                </ng-container>
                <!--<app-img class="img_i" *ngFor="let img of post.img" [img]="{id:img}"></app-img>-->
              </div>
            </div>
          </div>

          <div class="pst_btn">
            <div class="cmp-btn">
              <button class="button btnActive" [class.active]="checkShareActive(post.like)" (click)="liked(post)">
                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20" viewBox="0 0 456.814 456.814" fill="none"><path d="M441.11,252.677c10.468-11.99,15.704-26.169,15.704-42.54c0-14.846-5.432-27.692-16.259-38.547c-10.849-10.854-23.695-16.278-38.541-16.278h-79.082c0.76-2.664,1.522-4.948,2.282-6.851c0.753-1.903,1.811-3.999,3.138-6.283c1.328-2.285,2.283-3.999,2.852-5.139c3.425-6.468,6.047-11.801,7.857-15.985c1.807-4.192,3.606-9.9,5.42-17.133c1.811-7.229,2.711-14.465,2.711-21.698c0-4.566-0.055-8.281-0.145-11.134c-0.089-2.855-0.574-7.139-1.423-12.85c-0.862-5.708-2.006-10.467-3.43-14.272c-1.43-3.806-3.716-8.092-6.851-12.847c-3.142-4.764-6.947-8.613-11.424-11.565c-4.476-2.95-10.184-5.424-17.131-7.421c-6.954-1.999-14.801-2.998-23.562-2.998c-4.948,0-9.227,1.809-12.847,5.426c-3.806,3.806-7.047,8.564-9.709,14.272c-2.666,5.711-4.523,10.66-5.571,14.849c-1.047,4.187-2.238,9.994-3.565,17.415c-1.719,7.998-2.998,13.752-3.86,17.273c-0.855,3.521-2.525,8.136-4.997,13.845c-2.477,5.713-5.424,10.278-8.851,13.706c-6.28,6.28-15.891,17.701-28.837,34.259c-9.329,12.18-18.94,23.695-28.837,34.545c-9.899,10.852-17.131,16.466-21.698,16.847c-4.755,0.38-8.848,2.331-12.275,5.854c-3.427,3.521-5.14,7.662-5.14,12.419v183.01c0,4.949,1.807,9.182,5.424,12.703c3.615,3.525,7.898,5.38,12.847,5.571c6.661,0.191,21.698,4.374,45.111,12.566c14.654,4.941,26.12,8.706,34.4,11.272c8.278,2.566,19.849,5.328,34.684,8.282c14.849,2.949,28.551,4.428,41.11,4.428h4.855h21.7h10.276c25.321-0.38,44.061-7.806,56.247-22.268c11.036-13.135,15.697-30.361,13.99-51.679c7.422-7.042,12.565-15.984,15.416-26.836c3.231-11.604,3.231-22.74,0-33.397c8.754-11.611,12.847-24.649,12.272-39.115C445.395,268.286,443.971,261.055,441.11,252.677z" fill="transparent" stroke="#00a3ff" stroke-width="20" stroke-linejoin="round" /><path d="M100.5,191.864H18.276c-4.952,0-9.235,1.809-12.851,5.426C1.809,200.905,0,205.188,0,210.137v182.732c0,4.942,1.809,9.227,5.426,12.847c3.619,3.611,7.902,5.421,12.851,5.421H100.5c4.948,0,9.229-1.81,12.847-5.421c3.616-3.62,5.424-7.904,5.424-12.847V210.137c0-4.949-1.809-9.231-5.424-12.847C109.73,193.672,105.449,191.864,100.5,191.864z M67.665,369.308c-3.616,3.521-7.898,5.281-12.847,5.281c-5.14,0-9.471-1.76-12.99-5.281c-3.521-3.521-5.281-7.85-5.281-12.99c0-4.948,1.759-9.232,5.281-12.847c3.52-3.617,7.85-5.428,12.99-5.428c4.949,0,9.231,1.811,12.847,5.428c3.617,3.614,5.426,7.898,5.426,12.847C73.091,361.458,71.286,365.786,67.665,369.308z" fill="transparent" stroke="#00a3ff" stroke-width="20" stroke-linejoin="round"/></svg>
                <span class="btn-tt">Вподобати</span>
                <span class="btn-vl" *ngIf="post.like">{{post.like.length || ' '}}</span>
              </button>
            </div>

            <div class="cmp-btn">
              <button #comActiv class="button btnActive" [ngClass]="{'active': true}" (click)="comActiv.val=!comActiv.val">
                <label for="comment-{{post._id}}" class="button btnActive">
                  <svg class="act" xmlns="http://www.w3.org/2000/svg" width="16" height="16" x="0px" y="0px" viewBox="0 0 511.62 511.619"><g><g><path d="M301.923,327.602c30.93-13.038,55.34-30.785,73.228-53.248c17.891-22.458,26.837-46.915,26.837-73.372c0-26.458-8.946-50.914-26.837-73.376c-17.888-22.459-42.298-40.208-73.228-53.249c-30.93-13.039-64.571-19.556-100.928-19.556c-36.354,0-69.995,6.521-100.927,19.56C69.14,87.4,44.729,105.149,26.84,127.609C8.947,150.068,0,174.523,0,200.982c0,22.648,6.764,43.975,20.276,63.957c13.512,19.985,32.071,36.833,55.671,50.535c-1.902,4.572-3.853,8.754-5.852,12.566c-2,3.806-4.377,7.467-7.139,10.991c-2.76,3.525-4.899,6.283-6.423,8.275c-1.523,1.998-3.997,4.809-7.424,8.422c-3.428,3.617-5.618,5.996-6.567,7.135c0-0.191-0.383,0.24-1.143,1.287c-0.763,1.047-1.191,1.52-1.287,1.431c-0.094-0.103-0.476,0.373-1.141,1.42c-0.666,1.048-1,1.571-1,1.571l-0.715,1.423c-0.284,0.568-0.476,1.137-0.57,1.712c-0.096,0.567-0.144,1.19-0.144,1.854s0.094,1.28,0.286,1.854c0.383,2.471,1.477,4.466,3.284,5.996c1.809,1.52,3.757,2.279,5.854,2.279h0.857c9.515-1.332,17.701-2.854,24.552-4.569c29.312-7.614,55.771-19.797,79.372-36.545c17.128,3.046,33.88,4.568,50.248,4.568C237.349,347.156,270.994,340.641,301.923,327.602z M142.184,303.767l-12.564,8.846c-5.33,3.614-11.227,7.331-17.7,11.14l9.995-23.986l-27.694-15.988c-18.276-10.656-32.454-23.219-42.542-37.685c-10.089-14.465-15.131-29.502-15.131-45.111c0-19.417,7.474-37.594,22.414-54.534c14.938-16.94,35.067-30.358,60.382-40.259c25.313-9.895,52.532-14.847,81.653-14.847c29.121,0,56.342,4.952,81.654,14.847c25.313,9.9,45.442,23.319,60.388,40.259c14.94,16.939,22.408,35.116,22.408,54.534c0,19.414-7.468,37.59-22.408,54.53c-14.945,16.945-35.074,30.36-60.388,40.256c-25.312,9.897-52.53,14.846-81.654,14.846c-14.272,0-28.833-1.335-43.681-3.997L142.184,303.767z"/><path d="M491.347,338.156c13.518-19.896,20.272-41.255,20.272-64.098c0-23.411-7.139-45.303-21.409-65.666c-14.277-20.362-33.694-37.305-58.245-50.819c4.374,14.274,6.563,28.739,6.563,43.398c0,25.503-6.368,49.676-19.129,72.519c-12.752,22.836-31.025,43.01-54.816,60.524c-22.08,15.988-47.205,28.261-75.377,36.829c-28.164,8.562-57.573,12.848-88.218,12.848c-5.708,0-14.084-0.377-25.122-1.137c38.256,25.119,83.177,37.685,134.756,37.685c16.371,0,33.119-1.526,50.251-4.571c23.6,16.755,50.06,28.931,79.37,36.549c6.852,1.718,15.037,3.237,24.554,4.568c2.283,0.195,4.381-0.476,6.283-1.995c1.903-1.526,3.142-3.614,3.71-6.276c-0.089-1.143,0-1.77,0.287-1.861c0.281-0.09,0.233-0.712-0.144-1.852c-0.376-1.144-0.568-1.715-0.568-1.715l-0.712-1.424c-0.198-0.376-0.52-0.903-0.999-1.567c-0.476-0.66-0.855-1.14-1.143-1.427c-0.28-0.284-0.705-0.763-1.28-1.424c-0.568-0.66-0.951-1.092-1.143-1.283c-0.951-1.143-3.139-3.521-6.564-7.139c-3.429-3.613-5.899-6.42-7.422-8.418c-1.523-1.999-3.665-4.757-6.424-8.282c-2.758-3.518-5.14-7.183-7.139-10.991c-1.998-3.806-3.949-7.995-5.852-12.56C459.281,374.855,477.843,358.059,491.347,338.156z"/></g></g></svg>
                  <span class="btn-tt">Коментувати</span>
                  <span class="btn-vl" *ngIf="post.commentId">{{post.commentId.length || ' '}}</span>
                </label>
              </button>
            </div>

            <div class="cmp-btn">
              <button class="button btnActive" [ngClass]="{'active': true}"
                      (click)="popSpread.val=true;hidden(true)">
                <svg class="act" xmlns="http://www.w3.org/2000/svg" width="16" height="16" x="0px" y="0px" viewBox="0 0 487.958 487.958"><g><path d="M483.058,215.613l-215.5-177.6c-4-3.3-9.6-4-14.3-1.8c-4.7,2.2-7.7,7-7.7,12.2v93.6c-104.6,3.8-176.5,40.7-213.9,109.8c-32.2,59.6-31.9,130.2-31.6,176.9c0,3.8,0,7.4,0,10.8c0,6.1,4.1,11.5,10.1,13.1c1.1,0.3,2.3,0.4,3.4,0.4c4.8,0,9.3-2.5,11.7-6.8c73-128.7,133.1-134.9,220.2-135.2v93.3c0,5.2,3,10,7.8,12.2s10.3,1.5,14.4-1.8l215.4-178.2c3.1-2.6,4.9-6.4,4.9-10.4S486.158,218.213,483.058,215.613z M272.558,375.613v-78.1c0-3.6-1.4-7-4-9.5c-2.5-2.5-6-4-9.5-4c-54.4,0-96.1,1.5-136.6,20.4c-35,16.3-65.3,44-95.2,87.5c1.2-39.7,6.4-87.1,28.1-127.2c34.4-63.6,101-95.1,203.7-96c7.4-0.1,13.4-6.1,13.4-13.5v-78.2l180.7,149.1L272.558,375.613z"/></g></svg>
                <span class="btn-tt">Пoширити</span>
                <span class="btn-vl" *ngIf="post.shareCount">{{post.shareCount.length || ' '}}</span>
              </button>
            </div>
          </div>

          <!--Пост коментар-->
          <div class="pst_cm" [ngClass]="{'active': comActiv.val}" >
            <div class="post_cm">
              <ng-container *ngIf="post.commentId.length > 0">
                <ng-container *ngFor="let coment of post.commentId">
                  <article class="cm">
                    <div class="cm_us">
                      <img class="img"
                      [srcset]="'/-px100-'+coment.userIdCom.photo.picCrop.slice(1)+' 100w, /-px60-'+coment.userIdCom.photo.picCrop.slice(1)+' 60w'"
                      [src]="coment.userIdCom.photo.picCrop">
                      <!--<app-img size="60" class="img40 pre-bg" [img]="{id:coment.userIdCom.photo}"></app-img>-->

                      <div class="cm_us_in">
                        <p>
                          <strong class="cm_us_tt">{{coment.userIdCom.firstName}} {{coment.userIdCom.lastName}}</strong>
                        </p>
                        <p class="cm_us_data"><time>{{coment.data | date:"dd.MM.yyy HH:mm"}}</time></p>
                      </div>
                    </div>
                    <p class="cm_d">{{coment.des}}</p>
                  </article>
                </ng-container>
              </ng-container>

              <div class="cm_nw" *ngIf="estMyAvatar">
                <img class="img img40"
                [srcset]="'/-px100-'+estMyAvatar.picCrop.slice(1)+' 100w, /-px60-'+estMyAvatar.picCrop.slice(1)+' 60w'"
                [src]="estMyAvatar.picCrop">
                <!--<app-picture [pic]="estMyAvatar" size="60" class="img20"></app-picture>-->
                <!--<ng-container *ngIf=".picCrop">-->
                <!--<img class="img40 pre-bg" [src]="estMyAvatar.picCrop">-->
                <!--</ng-container>-->
                <ng-container *ngIf="!estMyAvatar.picCrop">
                  <app-prev-av></app-prev-av>
                </ng-container>
                <div class="cm_nw_com">
                  <div class="cm_fnt" #cmNewFn>{{des.value}}</div>
                  <textarea id="comment-{{post._id}}" class="cm_area" #des
                            placeholder="Поділіться своїми враженнями..."
                            (resize)="des.style.height = cmNewFn.offsetHeight + 'px'"
                            [style.height.px]="cmNewFn.offsetHeight"></textarea>

                  <button class="cm_btn" (click)="commented(post, des.value); des.value = ''">
                  <span class="svg20">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" x="0px" y="0px" viewBox="0 0 490.282 490.282" fill="#946fb0"><g><path class="act" d="M0.043,245.197c0.6,10.1,7.3,18.6,17,21.5l179.6,54.3l6.6,123.8c0.3,4.9,3.6,9.2,8.3,10.8c1.3,0.5,2.7,0.7,4,0.7c3.5,0,6.8-1.4,9.2-4.1l63.5-70.3l90,62.3c4,2.8,8.7,4.3,13.6,4.3c11.3,0,21.1-8,23.5-19.2l74.7-380.7c0.9-4.4-0.8-9-4.2-11.8c-3.5-2.9-8.2-3.6-12.4-1.9l-459,186.8C5.143,225.897-0.557,235.097,0.043,245.197z M226.043,414.097l-4.1-78.1l46,31.8L226.043,414.097z M391.443,423.597l-163.8-113.4l229.7-222.2L391.443,423.597z M432.143,78.197l-227.1,219.7l-179.4-54.2L432.143,78.197z"/></g></svg>
                  </span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </article>
        <div #popSpread class="cont md p-cont p-с pst-poh" [class.active]="popSpread.val">
          <button type="button" class="btn-trans btn-close o5" (click)="popSpread.val=!popSpread.val;hidden(false)">
            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 47.971 47.971" width="20" height="20"><g><path d="M28.228,23.986L47.092,5.122c1.172-1.171,1.172-3.071,0-4.242c-1.172-1.172-3.07-1.172-4.242,0L23.986,19.744L5.121,0.88c-1.172-1.172-3.07-1.172-4.242,0c-1.172,1.171-1.172,3.071,0,4.242l18.865,18.864L0.879,42.85c-1.172,1.171-1.172,3.071,0,4.242C1.465,47.677,2.233,47.97,3,47.97s1.535-0.293,2.121-0.879l18.865-18.864L42.85,47.091c0.586,0.586,1.354,0.879,2.121,0.879s1.535-0.293,2.121-0.879c1.172-1.171,1.172-3.071,0-4.242L28.228,23.986z"/></g></svg>
          </button>
          <div class="pst-poh_cm">
            <textarea #psPoh name="" class="ord_cm_t pst-poh_cm_t" [style.height.px]="psPohF.clientHeight" placeholder="Коментар до посту..."></textarea>
            <div #psPohF class="ord_cm_t-f pst-poh_cm_t-f">{{psPoh.value}}</div>
          </div>
          <div class="p-с_btn">
            <button class="btn-green btn-p"
                    (click)="addShare({postId:post._id,des:psPoh.value});popSpread.val=!popSpread.val;hidden(false)">
              Поширити
            </button>
          </div>
        </div>
        <div class="md-fixed" [class.active]="popSpread.val"  (click)="popSpread.val=!popSpread.val;hidden(false)"></div>
      </ng-container>
    </ng-container>

  </ng-container>
  <span appScrollRequest (request)="getMore()" *ngIf="isMore" style="display: none"></span>
</ng-container>

<app-custom-res style="display: none" [model]="{
  url:'me',
  security: true
}" (onRes)="result($event)" (onErr)="forbidden($event)"></app-custom-res>
